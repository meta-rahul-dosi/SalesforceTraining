/**
 * Test class to test the functionality of AccountContacts Class 
 */
@isTest
public class TestAccountWithContacts{
    
      //Method to test the formation of ContactIds field value with one contact in the account when ContactIds field is null
	@isTest static void testWithOneContactId(){
        Account acc = new Account(Name='Test Account' , ContactIds__c = null);
        insert acc;
        Contact con = new Contact(LastName='Test contact' , AccountId = acc.Id);
        insert con;
        AccountWithContacts.setContacts(con.id);
        Account resultantAccount = [SELECT ContactIDs__c FROM Account WHERE Id =: acc.Id];
        System.assertEquals(con.id , resultantAccount.ContactIDs__c , 'ContactIds field is not formed as expected');
    }
    
    
    //Method to test the formation of ContactIds field value with multiple contact in the account when ContactIds field is null
    @isTest static void testWithBulkContactIds(){
        Account acc = new Account(Name='Test Account' , ContactIds__c = null);
        insert acc;
        List<Contact> contactList = new List<Contact>();
        for(Integer i = 0; i < 10; i++){
            Contact oneContact = new Contact(LastName = 'Test contact ' + i , AccountId = acc.id);
            contactList.add(oneContact);
        }
        insert contactList;
       	AccountWithContacts.setContacts(contactList.get(0).id);
        Account resultantAccount = [SELECT ContactIDs__c FROM Account WHERE Id =: acc.Id];
        String testResult = '';
        for(Contact oneContact : contactList){
            testResult += oneContact.id + ',';
        }
        System.assertEquals(testResult.removeEnd(',') , resultantAccount.ContactIDs__c , 'ContactIds field is not formed as expected');
    }
}
